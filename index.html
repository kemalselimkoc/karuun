<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borsa Takip ve Analiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
        }

        .header {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .api-setup {
            background: rgba(255,255,255,0.1);
            margin: 20px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .api-input {
            padding: 10px;
            width: 300px;
            border: none;
            border-radius: 5px;
            margin: 10px;
            font-size: 16px;
        }

        .btn {
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(0,0,0,0.3);
            padding: 15px;
            margin: 20px;
            border-radius: 10px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .filters {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid transparent;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: white;
        }

        .stocks-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .stock-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s;
            position: relative;
        }

        .stock-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stock-symbol {
            font-size: 1.4em;
            font-weight: bold;
        }

        .stock-price {
            font-size: 1.6em;
            font-weight: bold;
        }

        .price-change {
            font-size: 0.9em;
            padding: 4px 8px;
            border-radius: 12px;
            margin-left: 10px;
        }

        .positive {
            background: rgba(76, 175, 80, 0.3);
            color: #4CAF50;
        }

        .negative {
            background: rgba(244, 67, 54, 0.3);
            color: #f44336;
        }

        .neutral {
            background: rgba(158, 158, 158, 0.3);
            color: #9e9e9e;
        }

        .signals {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            flex-wrap: wrap;
            gap: 5px;
        }

        .signal {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
            text-align: center;
            flex: 1;
            min-width: 70px;
        }

        .signal.buy {
            background: rgba(76, 175, 80, 0.8);
            color: white;
        }

        .signal.sell {
            background: rgba(244, 67, 54, 0.8);
            color: white;
        }

        .signal.hold {
            background: rgba(255, 193, 7, 0.8);
            color: black;
        }

        .indicators {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .indicator {
            background: rgba(0,0,0,0.2);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
        }

        .indicator-label {
            font-size: 0.8em;
            opacity: 0.8;
            display: block;
        }

        .indicator-value {
            font-size: 1.1em;
            font-weight: bold;
            margin-top: 2px;
        }

        .risk-level {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .risk-low {
            background: rgba(76, 175, 80, 0.8);
            color: white;
        }

        .risk-medium {
            background: rgba(255, 193, 7, 0.8);
            color: black;
        }

        .risk-high {
            background: rgba(244, 67, 54, 0.8);
            color: white;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
        }

        .mini-chart {
            height: 50px;
            margin: 10px 0;
            position: relative;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
            overflow: hidden;
        }

        .chart-line {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #2196F3);
            opacity: 0.6;
            border-radius: 5px;
        }

        @media (max-width: 768px) {
            .stocks-container {
                grid-template-columns: 1fr;
                padding: 10px;
            }
            
            .filters {
                flex-direction: column;
                align-items: center;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 10px;
            }
        }

        .error-message {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            padding: 15px;
            border-radius: 10px;
            margin: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìà Borsa Takip ve Analiz</h1>
        <p>S&P 500 Hisselerini Canlƒ± Takip Et</p>
    </div>

    <div class="api-setup" id="apiSetup">
        <h3>Alpha Vantage API Kurulumu</h3>
        <p>√úcretsiz API key almak i√ßin: <a href="https://www.alphavantage.co/support/#api-key" target="_blank" style="color: #4CAF50;">alphavantage.co</a></p>
        <p style="font-size: 0.9em; opacity: 0.8; margin: 10px 0;">Alpha Vantage CORS sorunlarƒ± olmayan, daha g√ºvenilir bir API servisidir.</p>
        <input type="text" id="apiKey" class="api-input" placeholder="Alpha Vantage API Key'inizi buraya girin">
        <button onclick="setApiKey()" class="btn">Ba≈ülat</button>
    </div>

    <div id="mainApp" style="display: none;">
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-number" id="totalStocks">0</span>
                <span>Toplam Hisse</span>
            </div>
            <div class="stat-item">
                <span class="stat-number positive" id="buySignals">0</span>
                <span>AL Sinyali</span>
            </div>
            <div class="stat-item">
                <span class="stat-number negative" id="sellSignals">0</span>
                <span>SAT Sinyali</span>
            </div>
            <div class="stat-item">
                <span class="stat-number neutral" id="holdSignals">0</span>
                <span>BEKLE Sinyali</span>
            </div>
        </div>

        <div class="filters">
            <button class="filter-btn active" onclick="filterStocks('all')">T√ºm√º</button>
            <button class="filter-btn" onclick="filterStocks('buy')">AL Sinyali</button>
            <button class="filter-btn" onclick="filterStocks('sell')">SAT Sinyali</button>
            <button class="filter-btn" onclick="filterStocks('hold')">BEKLE</button>
            <button class="filter-btn" onclick="filterStocks('high-risk')">Y√ºksek Risk</button>
        </div>

        <div class="stocks-container" id="stocksContainer">
            <div class="loading">Hisse verileri y√ºkleniyor...</div>
        </div>
    </div>

    <script>
        // S&P 500 benzeri pop√ºler hisseler (ilk 100 tanesi)
        const stocks = [
            'AAPL', 'MSFT', 'GOOGL', 'AMZN', 'NVDA', 'META', 'TSLA', 'BRK.B', 'UNH', 'JNJ',
            'JPM', 'V', 'PG', 'XOM', 'HD', 'CVX', 'MA', 'BAC', 'ABBV', 'PFE',
            'AVGO', 'KO', 'LLY', 'WMT', 'PEP', 'TMO', 'COST', 'DIS', 'ABT', 'CRM',
            'ACN', 'VZ', 'ADBE', 'DHR', 'NKE', 'TXN', 'NEE', 'BMY', 'QCOM', 'PM',
            'RTX', 'T', 'HON', 'UPS', 'LOW', 'SPGI', 'GS', 'LMT', 'MDT', 'SBUX',
            'AXP', 'BLK', 'BA', 'DE', 'AMD', 'C', 'AMGN', 'CAT', 'IBM', 'MU',
            'GILD', 'MMM', 'GE', 'NOW', 'BKNG', 'SYK', 'TJX', 'AMT', 'ADP', 'MO',
            'MDLZ', 'CVS', 'ZTS', 'ISRG', 'CB', 'TMUS', 'PLD', 'CI', 'SO', 'DUK',
            'ITW', 'EQIX', 'AON', 'CL', 'CSX', 'BSX', 'CME', 'FDX', 'MMC', 'ETN',
            'WM', 'APD', 'COP', 'ECL', 'SHW', 'DXCM', 'NSC', 'FCX', 'EMR', 'ROP'
        ];

        let apiKey = '';
        let stockData = {};
        let currentFilter = 'all';

        function setApiKey() {
            const input = document.getElementById('apiKey');
            if (input.value.trim()) {
                apiKey = input.value.trim();
                document.getElementById('apiSetup').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                initializeApp();
            } else {
                alert('L√ºtfen ge√ßerli bir API key girin!');
            }
        }

        function initializeApp() {
            loadStockData();
            // 5 dakikada bir g√ºncelle
            setInterval(loadStockData, 5 * 60 * 1000);
        }

        async function loadStockData() {
            console.log('Hisse verileri y√ºkleniyor...');
            
            for (let i = 0; i < Math.min(stocks.length, 25); i++) { // Alpha Vantage g√ºnl√ºk 25 bedava √ßaƒürƒ±
                const symbol = stocks[i];
                try {
                    await loadSingleStock(symbol);
                    // API rate limit i√ßin bekleme (Alpha Vantage dakikada 5 √ßaƒürƒ±)
                    await new Promise(resolve => setTimeout(resolve, 12000)); // 12 saniye bekle
                } catch (error) {
                    console.error(`${symbol} y√ºklenirken hata:`, error);
                }
            }
            
            updateDisplay();
        }

        async function loadSingleStock(symbol) {
            try {
                // CORS proxy kullanarak API √ßaƒürƒ±sƒ±
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const quoteResponse = await fetch(`${proxyUrl}https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`, {
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                const quote = await quoteResponse.json();
                
                if (quote.c === 0) return; // Ge√ßersiz veri

                // Temel teknik g√∂stergeler i√ßin basit hesaplamalar
                const price = quote.c;
                const change = quote.d;
                const changePercent = quote.dp;
                
                // Basit analiz ve sinyal √ºretimi
                const analysis = generateAnalysis(quote, symbol);
                
                stockData[symbol] = {
                    symbol: symbol,
                    price: price,
                    change: change,
                    changePercent: changePercent,
                    ...analysis,
                    lastUpdate: new Date()
                };
                
            } catch (error) {
                console.error(`Hata ${symbol}:`, error);
            }
        }

        function generateAnalysis(quote, symbol) {
            const price = quote.c;
            const change = quote.d;
            const changePercent = quote.dp;
            const volume = quote.v || Math.random() * 1000000; // Demo i√ßin
            
            // Basit teknik analiz sim√ºlasyonu
            const rsi = 30 + Math.random() * 40; // 30-70 arasƒ± RSI
            const macd = (Math.random() - 0.5) * 2; // -1 ile 1 arasƒ± MACD
            const volatility = Math.abs(changePercent) / 2 + Math.random() * 5;
            
            // Sinyal √ºretimi
            let signal = 'hold';
            let confidence = 50;
            
            if (changePercent > 2 && rsi < 70 && macd > 0) {
                signal = 'buy';
                confidence = 70 + Math.random() * 20;
            } else if (changePercent < -2 && rsi > 30 && macd < 0) {
                signal = 'sell';
                confidence = 70 + Math.random() * 20;
            } else if (Math.abs(changePercent) < 1) {
                signal = 'hold';
                confidence = 60 + Math.random() * 20;
            }
            
            // Risk seviyesi
            let riskLevel = 'low';
            if (volatility > 5) riskLevel = 'high';
            else if (volatility > 2.5) riskLevel = 'medium';
            
            return {
                signal: signal,
                confidence: Math.round(confidence),
                rsi: Math.round(rsi),
                macd: Math.round(macd * 100) / 100,
                volatility: Math.round(volatility * 10) / 10,
                riskLevel: riskLevel,
                volume: Math.round(volume)
            };
        }

        function updateDisplay() {
            const container = document.getElementById('stocksContainer');
            const data = Object.values(stockData);
            
            if (data.length === 0) {
                container.innerHTML = '<div class="loading">Veri y√ºkleniyor...</div>';
                return;
            }
            
            // ƒ∞statistikleri g√ºncelle
            updateStats(data);
            
            // Filtreleme
            const filteredData = filterData(data);
            
            // Hisse kartlarƒ±nƒ± olu≈ütur
            container.innerHTML = filteredData.map(stock => createStockCard(stock)).join('');
        }

        function updateStats(data) {
            const buyCount = data.filter(s => s.signal === 'buy').length;
            const sellCount = data.filter(s => s.signal === 'sell').length;
            const holdCount = data.filter(s => s.signal === 'hold').length;
            
            document.getElementById('totalStocks').textContent = data.length;
            document.getElementById('buySignals').textContent = buyCount;
            document.getElementById('sellSignals').textContent = sellCount;
            document.getElementById('holdSignals').textContent = holdCount;
        }

        function filterData(data) {
            switch(currentFilter) {
                case 'buy':
                    return data.filter(s => s.signal === 'buy');
                case 'sell':
                    return data.filter(s => s.signal === 'sell');
                case 'hold':
                    return data.filter(s => s.signal === 'hold');
                case 'high-risk':
                    return data.filter(s => s.riskLevel === 'high');
                default:
                    return data;
            }
        }

        function createStockCard(stock) {
            const changeClass = stock.change > 0 ? 'positive' : stock.change < 0 ? 'negative' : 'neutral';
            const signalText = stock.signal === 'buy' ? 'AL' : stock.signal === 'sell' ? 'SAT' : 'BEKLE';
            const riskText = stock.riskLevel === 'high' ? 'Y√ºksek' : stock.riskLevel === 'medium' ? 'Orta' : 'D√º≈ü√ºk';
            
            return `
                <div class="stock-card">
                    <div class="risk-level risk-${stock.riskLevel}">${riskText} Risk</div>
                    
                    <div class="stock-header">
                        <div>
                            <div class="stock-symbol">${stock.symbol}</div>
                        </div>
                        <div>
                            <span class="stock-price">$${stock.price.toFixed(2)}</span>
                            <span class="price-change ${changeClass}">
                                ${stock.change > 0 ? '+' : ''}${stock.change.toFixed(2)} (${stock.changePercent.toFixed(2)}%)
                            </span>
                        </div>
                    </div>
                    
                    <div class="mini-chart">
                        <div class="chart-line" style="height: ${Math.min(100, Math.abs(stock.changePercent) * 10 + 20)}%"></div>
                    </div>
                    
                    <div class="signals">
                        <div class="signal ${stock.signal}">
                            ${signalText} (%${stock.confidence})
                        </div>
                    </div>
                    
                    <div class="indicators">
                        <div class="indicator">
                            <span class="indicator-label">RSI</span>
                            <span class="indicator-value">${stock.rsi}</span>
                        </div>
                        <div class="indicator">
                            <span class="indicator-label">MACD</span>
                            <span class="indicator-value">${stock.macd}</span>
                        </div>
                        <div class="indicator">
                            <span class="indicator-label">Volatilite</span>
                            <span class="indicator-value">${stock.volatility}%</span>
                        </div>
                        <div class="indicator">
                            <span class="indicator-label">Hacim</span>
                            <span class="indicator-value">${(stock.volume / 1000).toFixed(0)}K</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function filterStocks(filter) {
            currentFilter = filter;
            
            // Aktif filtre butonunu g√ºncelle
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateDisplay();
        }

        // Sayfa y√ºklendiƒüinde demo verilerle ba≈ülat
        window.addEventListener('load', function() {
            console.log('Borsa Takip Uygulamasƒ± hazƒ±r!');
        });
    </script>
</body>
</html>
